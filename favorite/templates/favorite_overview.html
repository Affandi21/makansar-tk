{% extends 'base.html' %}
{% load static %}
{% block meta %}
<title>Favorite</title>
{% endblock meta %}

{% block content %}
<div class="bg-[#e8e8ed] font-sans">
    <div class="max-w-4xl mx-auto p-4">
        <!-- Top 3 Favorite Products -->
        <h3 class="text-lg font-bold text-gray-800 mb-2">Top 3 Produk Favorit Teratas</h3>
        <ul class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
            {% for top_product in top_three_favorites %}
                <li class="bg-white rounded-lg shadow p-4">
                    <h2 class="text-xs font-semibold text-gray-500 mb-1">Favorite Produk</h2>
                    <h3 class="text-lg font-bold text-gray-900 mb-2">{{ top_product.product.food_name }}</h3>
                    <p class="text-gray-700 mb-2 text-sm">Harga: {{ top_product.product.price }}</p>
                    
                    <!-- Remove from Top 3 Button -->
                    <form action="{% url 'favorite:toggle_top_three' top_product.product.id %}" method="post">
                        {% csrf_token %}
                        <button type="submit" class="text-red-500 hover:underline">Remove from Top 3</button>
                    </form>
                </li>
            {% empty %}
                <p>Anda belum memiliki produk favorit di Top 3.</p>
            {% endfor %}
        </ul>

        <!-- All Favorite Products with Toggle Button -->
        <h3 class="text-lg font-bold text-gray-800 mb-2">Semua Produk Favorit Anda</h3>
        <ul class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
            {% for favorite in all_favorites %}
                <li class="bg-white rounded-lg shadow p-4">
                    <h2 class="text-xs font-semibold text-gray-500 mb-1">Produk Favorit</h2>
                    <h3 class="text-lg font-bold text-gray-900 mb-2">{{ favorite.product.food_name }}</h3>
                    <p class="text-gray-700 text-sm">Harga: {{ favorite.product.price }}</p>
                    <form action="{% url 'favorite:delete_favorite' favorite.product.id %}" method="post" class="mt-2">
                        {% csrf_token %}
                        <button type="submit" class="text-red-500 hover:underline">Delete</button>
                    </form>
                    <form action="{% url 'favorite:toggle_top_three' favorite.product.id %}" method="post" class="mt-2">
                        {% csrf_token %}
                        {% if favorite.is_top_three %}
                            <button type="submit" class="text-red-500 hover:underline">Remove from Top 3</button>
                        {% else %}
                            <button type="submit" class="text-blue-500 hover:underline">Promote to Top 3</button>
                        {% endif %}
                    </form>
                </li>
            {% empty %}
                <p>Anda belum memiliki produk favorit.</p>
            {% endfor %}
        </ul>

        <!-- Add Products to Favorite -->
        <h3 class="text-lg font-bold text-gray-800 mb-2">Tambahkan Produk ke Favorit</h3>
        <ul class="grid grid-cols-1 md:grid-cols-3 gap-4">
            {% for product in all_products %}
                <li class="bg-white rounded-lg shadow p-4">
                    <h2 class="text-xs font-semibold text-gray-500 mb-1">Tambah Favorit</h2>
                    <h3 class="text-lg font-bold text-gray-900 mb-2">{{ product.food_name }}</h3>
                    <p class="text-gray-700 text-sm">Harga: {{ product.price }}</p>
                    <form action="{% url 'favorite:add_favorite' product.id %}" method="post" class="mt-2">
                        {% csrf_token %}
                        <button type="submit" class="text-blue-500 hover:underline">Add to Favorite</button>
                    </form>
                </li>
            {% empty %}
                <p>Tidak ada produk yang tersedia.</p>
            {% endfor %}
        </ul>
    </div>
</div>
{% endblock content %}
